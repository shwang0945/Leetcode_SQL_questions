1077. Project Employees III

My Answer:

SELECT p.project_id, p.employee_id
FROM (SELECT p.project_id, e.name, Max(e.experience_years) As years
FROM Project p , Employee e
WHERE p.employee_id = e.employee_id
GROUP BY p.project_id) a JOIN Project p ON a. project_id = p.project_id JOIN Employee e ON p.employee_id = e.employee_id
WHERE a.years = e.experience_years

Others:

MySQL

select p.project_id, p.employee_id
from Project p join Employee e
on p.employee_id = e.employee_id
where (p.project_id, e.experience_years) in (
    select a.project_id, max(b.experience_years)
    from Project a join Employee b
    on a.employee_id = b.employee_id
    group by a.project_id);
    
    
MSSQL - WINDOWS FUNCTION

select t.project_id, t.employee_id
from
    (select project_id,
    p.employee_id,
    rank() over(partition by project_id order by experience_years desc) as rank
    from Project p join Employee e
    on p.employee_id = e.employee_id) t
where t.rank = 1;



1126. Active Businesses

My Answer:

SELECT business_id
FROM Events e JOIN (SELECT event_type, Avg(occurences) As average_occurences
FROM Events
GROUP BY event_type) a ON e.event_type = a.event_type
WHERE e.occurences  > a.average_occurences
GROUP BY business_id HAVING COUNT(e.event_type) >1  

Others:

MS SQL - WINDOWSFUNCTION

select business_id from 
(
select  * , avg(occurences) over(partition by event_type ) as e_avg from 
events) a where occurences>e_avg
group by business_id having count(event_type)>1
